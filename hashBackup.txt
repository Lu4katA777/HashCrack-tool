#!/usr/bin/env python3

import hashlib
import argparse
import sys
from pathlib import Path
from colorama import Fore, Style, init

init(autoreset=True)

# ===== Banner =====
def banner():
    print(r"""
██╗  ██╗ █████╗ ███████╗██╗  ██╗
██║  ██║██╔══██╗██╔════╝██║  ██║
███████║███████║███████╗███████║
██╔══██║██╔══██║╚════██║██╔══██║
██║  ██║██║  ██║███████║██║  ██║
╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝
Mini Hash Tool - BG
""")

# ===== Warning =====
def warning_prompt():
    print(Fore.RED + "\n[!] Legal warning")
    print(Fore.YELLOW + "Please use this only for fun and learning.")
    print("Dont use for crime things.\n")

    choice = input("Do you want to continue? [Y/N]: ").lower()
    if choice != "y":
        print(Fore.RED + "Exiting...")
        sys.exit()

# ===== MUTATIONS =====
def generate_mutations(word):
    variations = set()

    variations.add(word)
    variations.add(word.lower())
    variations.add(word.upper())
    variations.add(word.capitalize())
    variations.add(word.swapcase())
    variations.add(word.title())

    # case per letter (за admiN тип)
    for i in range(len(word)):
        variations.add(word[:i] + word[i].upper() + word[i+1:])
        variations.add(word[:i] + word[i].lower() + word[i+1:])

    numbers = ["123","1234","12345","123456","2024","2025","2026"]

    for base in list(variations):
        for n in numbers:
            variations.add(base + n)

    return variations

# ===== Hash generator =====
def generate_hash(text, algorithm):
    h = hashlib.new(algorithm)
    h.update(text.encode())
    print(f"\n[+] Hash: {h.hexdigest()}\n")

# ===== Crack =====
def crack_hash(target_hash, wordlist_path, algorithm):
    path = Path(wordlist_path)

    if not path.exists():
        print("Wordlist not found")
        sys.exit()

    print(f"\n[*] Cracking using {algorithm}\n")

    attempts = 0

    with open(path, "r", errors="ignore") as f:
        for word in f:
            word = word.strip()

            mutations = generate_mutations(word)

            for variant in mutations:
                attempts += 1

                h = hashlib.new(algorithm)
                h.update(variant.encode())

                if h.hexdigest() == target_hash:
                    print(Fore.GREEN + f"\n[+] FOUND: {variant}")
                    print(f"[+] Base: {word}")
                    print(f"[+] Attempts: {attempts}\n")
                    return

                if attempts % 5000 == 0:
                    print(f"Checked: {attempts}")

    print(Fore.RED + "\n[-] Hash not found")

# ===== CLI =====
def main():
    parser = argparse.ArgumentParser()
    sub = parser.add_subparsers(dest="command")

    g = sub.add_parser("generate")
    g.add_argument("-t", "--text", required=True)
    g.add_argument("-a", "--algo", default="md5")

    c = sub.add_parser("crack")
    c.add_argument("-hsh", "--hash", required=True)
    c.add_argument("-w", "--wordlist", required=True)
    c.add_argument("-a", "--algo", default="md5")

    args = parser.parse_args()
    banner()

    if args.command == "generate":
        warning_prompt()
        generate_hash(args.text, args.algo)

    elif args.command == "crack":
        warning_prompt()
        crack_hash(args.hash, args.wordlist, args.algo)

if __name__ == "__main__":
    main()
